document.addEventListener("DOMContentLoaded",function(){window.URL||widndow.webkitURL;if("/admin/products/new"===window.location.pathname){function e(e,t,i){return`\n\t\t\t\t<div class="ui ${i} message">\n\t\t\t\t\t<i class="close icon"></i>\n\t\t\t\t\t<div class="header">\n\t\t\t\t\t\t${e}!\n\t\t\t\t\t</div>\n\t\t\t\t\t${t}\n\t\t\t\t</div>\n\t\t\t`}for(var t=document.querySelector("#cover"),i=document.querySelector("#imgPreview"),n=document.querySelector(".custom-file-upload"),o=document.querySelector("#imgPreviewContainer"),r=document.querySelector("#messages"),s=document.querySelector("#aspectRatioButtons"),c=document.querySelectorAll(".ratioBtn"),a=document.getElementById("imgBtns"),d=1,l=400,g=400,u=0;u<c.length;u++)c[u].addEventListener("click",function(e){e.preventDefault(),console.log(this),d=this.getAttribute("ratio"),l=Number(this.getAttribute("width")),g=Number(this.getAttribute("height")),m(d,l,g)});function m(e,t,i){$("#imgPreview").cropper("destroy").cropper({aspectRatio:e,viewMode:1,responsive:!0,background:!0,modal:!1,zoomable:!0,zoomOnTouch:!0,cropBoxResizable:!0,minCropBoxWidth:t,minCropBoxHeight:i,ready:function(){}})}function p(){r.innerHTML="",t.value=""}t.addEventListener("change",function(t){if(h=3e6,(!(this.files[0].size>h)||(p(),r.innerHTML=`${e("Внимание","Максимальный размер фотографии является 3МБ.","warning")}`,0))&&(u=u="cover","image/jpg"===(v=(v=document.getElementById(u).files[0].type).toString())||"image/png"===v||"image/jpeg"===v||"image/bmp"===v||(p(),r.innerHTML=`${e("Внимание","Формат фотографии не разрешен. Фотографии могут быть формата jpg, jpeg, png или gif.","warning")}`,0))){r.innerHTML="";var c=new FileReader;c.onload=function(e){i.src=e.target.result,i.onload=function(){n.classList.toggle("hidden"),o.classList.toggle("hidden"),s.classList.toggle("hidden"),a.classList.toggle("hidden"),m(d,l,g)}},c.readAsDataURL(this.files[0])}var u,v,h}),$("#submitImage").on("click",function(t){t.preventDefault(),cover=$("#imgPreview").cropper("getData",!0),$.post("/admin/products/cropperdata",cover,function(t){"success"===t&&($("#imgPreview").cropper("destroy"),$("#imgPreview").removeAttr("src"),n.classList.toggle("hidden"),o.classList.toggle("hidden"),s.classList.toggle("hidden"),a.classList.toggle("hidden"),$("#imageInput").prop("disabled",!0),$("html, body").animate({scrollTop:0},"medium"),r.innerHTML=`${e("Onnistui!","Kuva on onnistuneesti lähetetty palvelimelle.","success")}`)})})}});