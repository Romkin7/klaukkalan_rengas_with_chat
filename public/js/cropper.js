document.addEventListener("DOMContentLoaded",function(){window.URL||widndow.webkitURL;if("/admin/products/new"===window.location.pathname){function e(){return $("html, body").animate({scrollTop:0},"medium")}function t(e,t,i){return`\n\t\t\t\t<div class="ui ${i} message">\n\t\t\t\t\t<i class="close icon"></i>\n\t\t\t\t\t<div class="header">\n\t\t\t\t\t\t${e}!\n\t\t\t\t\t</div>\n\t\t\t\t\t${t}\n\t\t\t\t</div>\n\t\t\t`}for(var i=document.querySelector("#cover"),n=document.querySelector("#imgPreview"),o=document.querySelector(".custom-file-upload"),r=document.querySelector("#imgPreviewContainer"),s=document.querySelector("#messages"),c=document.querySelector("#aspectRatioButtons"),d=document.querySelectorAll(".ratioBtn"),a=document.getElementById("imgBtns"),l=1,g=400,u=400,m=0;m<d.length;m++)d[m].addEventListener("click",function(e){e.preventDefault(),console.log(this),l=this.getAttribute("ratio"),g=Number(this.getAttribute("width")),u=Number(this.getAttribute("height")),p(l,g,u)});function p(e,t,i){$("#imgPreview").cropper("destroy").cropper({aspectRatio:e,viewMode:1,responsive:!0,background:!0,modal:!1,zoomable:!0,zoomOnTouch:!0,cropBoxResizable:!0,minCropBoxWidth:t,minCropBoxHeight:i,ready:function(){}})}i.addEventListener("change",function(e){if(h=3e6,(!(this.files[0].size>h)||(i.value="",s.innerHTML=`${t("Внимание","Максимальный размер фотографии является 3МБ.","warning")}`,0))&&(m=m="cover","image/jpg"===(v=(v=document.getElementById(m).files[0].type).toString())||"image/png"===v||"image/jpeg"===v||"image/bmp"===v||(i.value="",s.innerHTML=`${t("Внимание","Формат фотографии не разрешен. Фотографии могут быть формата jpg, jpeg, png или gif.","warning")}`,0))){s.innerHTML="";var d=new FileReader;d.onload=function(e){n.src=e.target.result,n.onload=function(){o.classList.toggle("hidden"),r.classList.toggle("hidden"),c.classList.toggle("hidden"),a.classList.toggle("hidden"),p(l,g,u)}},d.readAsDataURL(this.files[0])}var m,v,h}),$("#submitImage").on("click",function(i){i.preventDefault(),cover=$("#imgPreview").cropper("getData",!0),$.post("/admin/products/cropperdata",cover,function(i){"success"===i&&($("#imgPreview").cropper("destroy"),$("#imgPreview").removeAttr("src"),o.classList.toggle("hidden"),r.classList.toggle("hidden"),c.classList.toggle("hidden"),a.classList.toggle("hidden"),$("#imageInput").prop("disabled",!0),e(),s.innerHTML=`${t("Onnistui!","Kuva on onnistuneesti lähetetty palvelimelle.","success")}`)})}),$("#resetImage").on("click",function(t){t.preventDefault(),e(),s.innerHTML="",i.value="",$("#imgPreview").cropper("destroy"),$("#imgPreview").removeAttr("src"),o.classList.toggle("hidden"),r.classList.toggle("hidden"),c.classList.toggle("hidden"),a.classList.toggle("hidden")})}});