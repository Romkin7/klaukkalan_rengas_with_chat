document.addEventListener("DOMContentLoaded",function(){window.URL||widndow.webkitURL;if("/admin/products/new"===window.location.pathname){function e(e,t,i){return`\n\t\t\t\t<div class="ui ${i} message">\n\t\t\t\t\t<i class="close icon"></i>\n\t\t\t\t\t<div class="header">\n\t\t\t\t\t\t${e}!\n\t\t\t\t\t</div>\n\t\t\t\t\t${t}\n\t\t\t\t</div>\n\t\t\t`}for(var t=document.querySelector("#cover"),i=document.querySelector("#imgPreview"),n=document.querySelector(".custom-file-upload"),o=document.querySelector("#imgPreviewContainer"),s=document.querySelector("#messages"),r=document.querySelector("#aspectRatioButtons"),c=document.querySelectorAll(".ratioBtn"),d=document.getElementById("imgBtns"),a=1,l=400,g=400,u=0;u<c.length;u++)c[u].addEventListener("click",function(e){e.preventDefault(),console.log(this),a=this.getAttribute("ratio"),l=Number(this.getAttribute("width")),g=Number(this.getAttribute("height")),m(a,l,g)});function m(e,t,i){$("#imgPreview").cropper("destroy").cropper({aspectRatio:e,viewMode:1,responsive:!0,background:!0,modal:!1,zoomable:!0,zoomOnTouch:!0,cropBoxResizable:!0,minCropBoxWidth:t,minCropBoxHeight:i,ready:function(){}})}t.addEventListener("change",function(c){if(h=3e6,(!(this.files[0].size>h)||(t.value="",s.innerHTML=`${e("Внимание","Максимальный размер фотографии является 3МБ.","warning")}`,0))&&(p=p="cover","image/jpg"===(v=(v=document.getElementById(p).files[0].type).toString())||"image/png"===v||"image/jpeg"===v||"image/bmp"===v||(t.value="",s.innerHTML=`${e("Внимание","Формат фотографии не разрешен. Фотографии могут быть формата jpg, jpeg, png или gif.","warning")}`,0))){s.innerHTML="";var u=new FileReader;u.onload=function(e){i.src=e.target.result,i.onload=function(){n.classList.toggle("hidden"),o.classList.toggle("hidden"),r.classList.toggle("hidden"),d.classList.toggle("hidden"),m(a,l,g)}},u.readAsDataURL(this.files[0])}var p,v,h}),$("#submitImage").on("click",function(t){t.preventDefault(),cover=$("#imgPreview").cropper("getData",!0),$.post("/admin/products/cropperdata",cover,function(t){"success"===t&&($("#imgPreview").cropper("destroy"),$("#imgPreview").removeAttr("src"),n.classList.toggle("hidden"),o.classList.toggle("hidden"),r.classList.toggle("hidden"),d.classList.toggle("hidden"),$("#imageInput").prop("disabled",!0),$("html, body").animate({scrollTop:0},"medium"),s.innerHTML=`${e("Onnistui!","Kuva on onnistuneesti lähetetty palvelimelle.","success")}`)})}),$("#resetImage").on("click",function(e){e.preventDefault(),s.innerHTML="",t.value="",$("#imgPreview").cropper("destroy"),$("#imgPreview").removeAttr("src"),n.classList.toggle("hidden"),o.classList.toggle("hidden"),r.classList.toggle("hidden"),d.classList.toggle("hidden")})}});